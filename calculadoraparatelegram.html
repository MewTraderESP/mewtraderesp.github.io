<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="robots" content="noindex,nofollow">
<title>Mew Trader_ESP ¬∑ Calculadora de Precio Promedio & Stop Loss</title>

<script>
/* üîê Protecci√≥n por contrase√±a simple */
const acceso = prompt("Introduce la clave de acceso:");
if (acceso !== "MewTrader2025") {
  document.write("<body style='background:#0b0f13;color:#ff6a6a;font-family:sans-serif;display:flex;align-items:center;justify-content:center;height:100vh;'><h2>‚õî Acceso denegado</h2></body>");
  throw new Error("Acceso no autorizado");
}
</script>

<style>
:root{--bg:#0b0f13;--card:#121822;--muted:#7b8aa0;--fg:#e8eef7;--accent:#3aa9ff;--accent-2:#7cffb2;--danger:#ff5a7d}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:linear-gradient(180deg,#0b0f13 0%,#0d1219 100%);color:var(--fg);display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:24px}
header{text-align:center;margin-bottom:30px}
header h1{font-size:2.6rem;font-weight:900;letter-spacing:1px;margin:0;color:#3aa9ff}
header img{display:block;margin:20px auto;border-radius:20px;max-width:200px}
header a{color:#7cffb2;text-decoration:none;font-weight:600}
.app{width:100%;max-width:980px}
.title{text-align:center;font-size:clamp(20px,2.6vw,28px);font-weight:800;margin:0 0 14px}
.subtitle{text-align:center;color:var(--muted);margin:0 0 22px;font-size:14px}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
.card{grid-column:span 12;background:linear-gradient(180deg,#0f1520 0%,#0e141d 100%);border:1px solid #1a2230;border-radius:16px;padding:18px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
@media(min-width:860px){.card.half{grid-column:span 6}}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.field{display:flex;flex-direction:column;gap:8px}
label{font-size:12px;color:var(--muted);letter-spacing:.3px}
input[type=number]{appearance:textfield}
input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{appearance:none;margin:0}
.input{background:#0b111a;border:1px solid #1b2636;border-radius:12px;padding:12px;font-size:14px;color:var(--fg);outline:none;transition:.15s}
.input:focus{border-color:#2c74ff;box-shadow:0 0 0 3px rgba(60,140,255,.15)}
.weights{display:flex;gap:8px;flex-wrap:wrap}
.pill{background:#0c1320;border:1px solid #182235;color:#c6d3e8;border-radius:999px;padding:6px 10px;font-size:12px}
.result{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border:1px dashed #223049;border-radius:12px;background:linear-gradient(180deg,#0b1119 0%,#0c1118 100%)}
.res-title{font-size:12px;color:var(--muted)}
.res-value{font-variant-numeric:tabular-nums;font-weight:700;letter-spacing:.3px}
.accent{color:var(--accent)}.bad{color:var(--danger)}
.footer{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
button{cursor:pointer;border:1px solid #1b2636;background:#0f1724;color:#dbe6f7;border-radius:12px;padding:10px 14px;font-weight:600;letter-spacing:.2px}
button:hover{border-color:#2c74ff;box-shadow:0 0 0 3px rgba(60,140,255,.12)}
.muted{color:var(--muted)}.mono{font-family:ui-monospace,monospace}
</style>
</head>

<body>
<header>
  <h1>Mew Trader_ESP</h1>
  <img src="qr_telegram.png" alt="QR Telegram Mew Trader" width="200" height="200">
  <p><a href="https://t.me/MewTraderESP" target="_blank">https://t.me/MewTraderESP</a></p>
</header>

<div class="app">
  <h2 class="title">Calculadora de Precio Promedio & Stop Loss</h2>
  <p class="subtitle">Entradas escalonadas <strong>15% / 30% / 55%</strong>. Calcula precio medio y SL para LONG/SHORT seg√∫n capital, apalancamiento y riesgo m√°ximo.</p>

  <div class="grid">
    <section class="card half">
      <h3 style="margin:0 0 12px">Par√°metros</h3>
      <div class="row" style="margin-bottom:10px">
        <div class="field"><label>Capital total (USD)</label><input id="capital" class="input" type="number" value="100"></div>
        <div class="field"><label>Apalancamiento (x)</label><input id="lev" class="input" type="number" value="10"></div>
      </div>
      <div class="row" style="margin-bottom:10px">
        <div class="field"><label>Riesgo m√°ximo (%)</label><input id="risk" class="input" type="number" value="30"></div>
        <div class="field"><label>Pesos fijos</label><div class="weights"><span class="pill">15%</span><span class="pill">30%</span><span class="pill">55%</span></div></div>
      </div>
      <div class="row">
        <div class="field"><label>Entrada 1 (15%)</label><input id="p1" class="input" type="number" value="100000"></div>
        <div class="field"><label>Entrada 2 (30%)</label><input id="p2" class="input" type="number" value="98500"></div>
      </div>
      <div class="row" style="margin-top:10px">
        <div class="field"><label>Entrada 3 (55%)</label><input id="p3" class="input" type="number" value="96800"></div>
        <div class="field"><label>Riesgo en USD</label>
          <div class="result"><span class="res-title">Riesgo</span><span id="riskUsd" class="res-value bad mono">$0.00</span></div>
        </div>
      </div>
      <div class="footer">
        <button id="reset">Restablecer</button>
        <button id="copy">Copiar resultados</button>
      </div>
    </section>

    <section class="card half">
      <h3 style="margin:0 0 12px">Resultados</h3>

      <div class="field" style="margin-bottom:12px">
        <label>Precio promedio</label>
        <div class="result"><span class="res-title">USD por unidad</span><span id="avg" class="res-value accent mono">‚Äî</span></div>
      </div>

      <div id="detalleEntradas" style="margin-top:10px;color:#cbd6e8;font-size:13px;line-height:1.6"></div>

      <div class="row" style="margin-top:14px">
        <div class="field"><label>Stop Loss (LONG)</label>
          <div class="result"><span class="res-title">Promedio ‚àí p√©rdida</span><span id="slLong" class="res-value bad mono">‚Äî</span></div>
        </div>
        <div class="field"><label>Stop Loss (SHORT)</label>
          <div class="result"><span class="res-title">Promedio + p√©rdida</span><span id="slShort" class="res-value bad mono">‚Äî</span></div>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
(function(){
const $=id=>document.getElementById(id);
const fmtUSD=v=>isFinite(v)?new Intl.NumberFormat('es-ES',{style:'currency',currency:'USD',maximumFractionDigits:2}).format(v):'‚Äî';
const fmtBTC=v=>isFinite(v)?new Intl.NumberFormat('es-ES',{minimumFractionDigits:6,maximumFractionDigits:8}).format(v):'‚Äî';
const out={avg:$('avg'),slLong:$('slLong'),slShort:$('slShort'),riskUsd:$('riskUsd')};

function calc(){
  const capital=+$('capital').value||0,lev=Math.max(1,+$('lev').value||0),riskPct=Math.max(0,+$('risk').value||0);
  const p1=+$('p1').value||0,p2=+$('p2').value||0,p3=+$('p3').value||0;
  if(!(p1>0&&p2>0&&p3>0&&capital>0&&lev>=1)){
    Object.values(out).forEach(e=>e.textContent='‚Äî');
    $('detalleEntradas').innerHTML='';
    return;
  }

  const pesos=[0.15,0.30,0.55];
  const precios=[p1,p2,p3];
  const montos=pesos.map(p=>capital*p);
  const qtys=montos.map((m,i)=>m/precios[i]);
  const totalQty=qtys.reduce((a,b)=>a+b,0);
  const avg=capital/totalQty;
  const riskUsd=capital*(riskPct/100);
  const nominal=capital*lev;
  const qtyNom=nominal/avg;
  const lossPerBTC=riskUsd/qtyNom;
  const slLong=avg-lossPerBTC;
  const slShort=avg+lossPerBTC;

  out.avg.textContent=fmtUSD(avg);
  out.slLong.textContent=fmtUSD(slLong);
  out.slShort.textContent=fmtUSD(slShort);
  out.riskUsd.textContent=fmtUSD(riskUsd);

  // Bloque dentro del panel de resultados
  let html="";
  precios.forEach((precio,i)=>{
    html+=`<p>Entrada ${i+1} a <strong>${fmtUSD(precio)}</strong> ‚Üí inversi√≥n <strong>${fmtUSD(montos[i])}</strong> (${(pesos[i]*100).toFixed(0)}% del capital)</p>`;
  });
  $('detalleEntradas').innerHTML=html;
}

['capital','lev','risk','p1','p2','p3'].forEach(id=>$(id).addEventListener('input',calc));
$('reset').addEventListener('click',()=>{$('capital').value=100;$('lev').value=10;$('risk').value=30;$('p1').value=100000;$('p2').value=98500;$('p3').value=96800;calc();});
$('copy').addEventListener('click',async()=>{const txt=document.body.innerText;await navigator.clipboard.writeText(txt);alert('Resultados copiados.');});
calc();
})();
</script>
</body>
</html>
